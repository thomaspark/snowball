jQuery(document).ready(function(a){function t(){function t(t,o){var r=a(o).parents(".snowball-block").data("name"),c="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target]",l=a(o).find(c);if(l){var i={blockType:r,orderNumber:t};l.each(function(t,e){var n=a(e).attr("data-target"),o=a(e).val();"checkbox"==a(e).attr("type")&&(o=a(e).is(":checked")?!0:!1),i[n]=o});var d=a(o).closest(".snowball-block");i.customCss=n(d),e.push(i)}}var e=[];return a("#snowball-main form").each(t),e}function e(){var a="";return jQuery(".snowball-preview").each(function(t,e){a=a+"\n"+jQuery(e).contents().find("body").html()}),a}function n(t){var e,n=a(t).find(".snowball-code .CodeMirror");if(0===n.length)e=a(t).find("textarea[data-mode='css']").html();else{var o=n[1].CodeMirror,r=o.getAllMarks();if(e=o.getValue(),r.length){var c=r[0],l=c.lines.length;if(2>l)e=o.getValue();else{var i={line:l-1,ch:0},d={line:o.lastLine()+1,ch:0};e=o.getRange(i,d)}}}return e}a("#publish").click(function(){var n=t(),o=e(),r={action:"add_blocks",blocks:n,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},c={action:"add_article",article:o,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};a.post(ajax_object.ajax_url,c),a.post(ajax_object.ajax_url,r)})});