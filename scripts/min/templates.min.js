function drawBargraph(t){var a=t.find(".json").val(),n=t.find(".chart").get(0),e=(t.find(".size").val(),JSON.parse(a)),o={top:40,right:40,bottom:60,left:30},r=800-o.left-o.right,l=400-o.top-o.bottom,i=d3.scale.ordinal().rangeRoundBands([0,r],.05),s=d3.scale.linear().range([l,0]),c=d3.svg.axis().scale(i).orient("bottom"),d=d3.svg.axis().scale(s).orient("left").ticks(10),p=d3.select(n).append("svg").attr("width",r+o.left+o.right).attr("height",l+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")");i.domain(e.map(function(t){return t.label})),s.domain([0,d3.max(e,function(t){return t.value})]),p.append("g").attr("class","x axis").attr("transform","translate(0,"+l+")").call(c),p.append("g").attr("class","y axis").call(d),p.selectAll("bar").data(e).enter().append("rect").attr("x",function(t){return i(t.label)}).attr("width",i.rangeBand()).attr("y",function(t){return s(t.value)}).attr("height",function(t){return l-s(t.value)})}function drawMap(t){var a=a||window.parent.snowball,n=a.pluginsUrl+"/lib/d3-geomap",e=t.find(".json-usa").val(),o=t.find(".map").get(0),r=parseInt(t.find("input.quantize").val()),l=t.find("input.color").val(),i=colorbrewer[l][r],s=t.find(".map-type").val(),c=n+"/topojson/countries/USA.json",d=d3.geo.albersUsa,p=800;if("world"===s&&(e=t.find(".json-world").val(),c=n+"/topojson/world/countries.json",d=d3.geo.equirectangular,p=100),e){t.find(".map").empty();var u=d3.geomap.choropleth().geofile(c).projection(d).column("Value").unitId("fips").scale(p).translate([400,200]).colors(i).legend(!0);d3.select(o).datum(JSON.parse(e)).call(u.draw,u).selectAll("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 500 400")}}function drawScatterplot(t){var a=t.find(".json").val();if(a){var n=t.find(".chart").get(0),e=t.find(".size").val(),o=JSON.parse(a),r=[],l=[],i=[];o.forEach(function(t){r.push([t.X,t.Y]),l.push(t.X),i.push(t.Y)});var s={top:40,right:40,bottom:60,left:60},c=800-s.left-s.right,d=400-s.top-s.bottom,p=d3.scale.linear().domain([0,d3.max(l)]).range([0,c]),u=d3.scale.linear().domain([0,d3.max(i)]).range([d,0]),f=d3.select(n).append("svg:svg").attr("width",c+s.right+s.left).attr("height",d+s.top+s.bottom).attr("class","chart"),h=f.append("g").attr("transform","translate("+s.left+","+s.top+")").attr("width",c).attr("height",d).attr("class","main"),m=d3.svg.axis().scale(p).orient("bottom");h.append("g").attr("transform","translate(0,"+d+")").attr("class","main axis date").call(m);var g=d3.svg.axis().scale(u).orient("left");h.append("g").attr("transform","translate(0,0)").attr("class","main axis date").call(g);var w=h.append("svg:g");w.selectAll("scatter-dots").data(i).enter().append("svg:circle").attr("cy",function(t){return u(t)}).attr("cx",function(t,a){return p(l[a])}).attr("r",e)}}!function(t){t(document).ready(function(){var a=t(".snowball-block-bargraph");a.each(function(){drawBargraph(t(this))})})}(jQuery),function(t){t(document).ready(function(){var a=t(".snowball-block-choropleth");a.each(function(){drawMap(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-contact .submit",function(){var a=t(this).closest("form"),n=a.find("[name='to']").val(),e=a.find("[name='subject']").val(),o=a.find("[name='confirmation']").val(),r="",l=a.find("input, textarea").not("[type='hidden']");l.each(function(){var a=t(this).val();r=t(this).attr("name")?r+"\n\n"+t(this).attr("name")+": "+a:r+"\n\n"+a});var i={action:"mail_before_submit",to:n,subject:e,message:r};window.parent&&(snowball=window.parent.snowball),jQuery.post(snowball.adminUrl+"admin-ajax.php",i,function(t){a.text(o)})})})}(jQuery),function(t){t(document).ready(function(){var a=t(".snowball-block-scatterplot");a.each(function(){drawScatterplot(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-share .button",function(){var t,a=a||window.parent.snowball,n=jQuery(this),e=500,o=400,r=screen.width/2-e/2,l=screen.height/2-o/2,i="toolbar=0,status=0,width="+e+",height="+o+",top="+l+",left="+r;t=n.hasClass("facebook")?"http://www.facebook.com/sharer.php?u="+encodeURIComponent(a.url):n.hasClass("twitter")?"http://twitter.com/share?url="+encodeURIComponent(a.url)+"&text="+encodeURIComponent(a.title):n.hasClass("tumblr")?"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl="+encodeURIComponent(a.url)+"&title="+encodeURIComponent(a.title)+"&content="+encodeURIComponent(a.excerpt):"https://plus.google.com/share?url="+encodeURIComponent(a.url),window.open(t,"share",i)})})}(jQuery);
//# sourceMappingURL=templates.min.js.map